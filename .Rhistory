nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
total_returns <- rowSums(returns*w)
return(total_returns)
}
rowSums(r*w) - calc_factors(size_mom_25)
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
total_returns <- rowSums((returns*w)[,-1])
return(total_returns)
}
rowSums(r*w) - calc_factors(size_mom_25)
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
total_returns <- rowSums((returns*w)[,-1])
return(returns)
}
calc_factors(size_mom_25)
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
total_returns <- rowSums((returns*w)[,-1])
return(returns[,-1])
}
calc_factors(size_mom_25)
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
total_returns <- rowSums(returns*w)
return(total_returns)
}
calc_factors(size_mom_25)
size_mom_6$subsets$name # De forskellige datasets
# Plot af de forskellige dataset i size_mom_6
k <- 6
filter(size_mom_6$subsets$data[[k]], date >= 200409) %>%
mutate(date = ym(date)) %>%
pivot_longer(cols = -date,
names_to = "group",
values_to = "value") %>%
ggplot(aes(date, value, color = group)) +
geom_line() +
facet_wrap(~group, scales = "free") +
theme(legend.position = "bottom") +
ggtitle(size_mom_6$subsets$name[k])
# Total return
# Ved ikke lige hvordan dette skulle regnes, men ud fra hint og at det er givet som et vægtet gennemsnit kunne det være dette
# r er Average Value Weighted Returns -- Monthly
# n er Number of Firms in Portfolios
# a er Average Firm Size (market cap)
r <- filter(size_mom_25$subsets$data[[1]], date >= 200409)[,-1]
r.e <- filter(size_mom_25$subsets$data[[2]], date >= 200409)[,-1]
n <- filter(size_mom_25$subsets$data[[5]], date >= 200409)[,-1]
a <- filter(size_mom_25$subsets$data[[6]], date >= 200409)[,-1]
total_returns_6 <- tibble(date = size_mom_6$subsets$data[[1]]$date, r*n*a)
n
r.e
w <- a*n/rowSums(a*n)
rowSums(r*w)
hist(round(round(rowSums(r*w), 2)-(ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))$`Mkt-RF`+(ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))$RF, 2))
calc_factors(size_mom_25) - rowSums(r*w)
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
equal_returns <- returns*w
Mkt <- rowSums(equal_returns)
return(equal_returns)
}
calc_factors(size_mom_25)
calc_factors(size_mom_25)
browse_details_page(size_mom_6)
size_mom_25$subsets$name
size_mom_25$subsets$data[[1]]
size_mom_6
size_mom_6$subsets$data[[1]]
size_mom_25$subsets$data[[1]]
size_mom_6$subsets$data[[1]]
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
equal_returns <- returns*w
Mkt <- rowSums(equal_returns)
SMB <- rowMeans(equal_returns[1:3]) - rowMeans(equal_returns[[4:6]])
MOM <- rowMeans(equal_returns[c(3, 6)]) - rowMeans(equal_returns[c(1, 4)])
df <- tibble("date" = filter_data(data_matrix$subsets$data[[1]], annual)[1], "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
browse_details_page(size_mom_6)
calc_factors(size_mom_6)
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
equal_returns <- returns*w
Mkt <- rowSums(equal_returns)
SMB <- rowMeans(equal_returns[1:3]) - rowMeans(equal_returns[[4:6]])
MOM <- rowMeans(equal_returns[c(3, 6)]) - rowMeans(equal_returns[c(1, 4)])
#df <- tibble("date" = filter_data(data_matrix$subsets$data[[1]], annual)[1], "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(Mkt)
}
calc_factors(size_mom_6)
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
equal_returns <- returns*w
Mkt <- rowSums(equal_returns)
SMB <- rowMeans(equal_returns[1:3]) - rowMeans(equal_returns[4:6])
MOM <- rowMeans(equal_returns[c(3, 6)]) - rowMeans(equal_returns[c(1, 4)])
#df <- tibble("date" = filter_data(data_matrix$subsets$data[[1]], annual)[1], "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(Mkt)
}
calc_factors(size_mom_6)
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
equal_returns <- returns*w
Mkt <- rowSums(equal_returns)
SMB <- rowMeans(equal_returns[1:3]) - rowMeans(equal_returns[4:6])
MOM <- rowMeans(equal_returns[c(3, 6)]) - rowMeans(equal_returns[c(1, 4)])
df <- tibble("date" = filter_data(data_matrix$subsets$data[[1]], annual)[1], "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
calc_factors(size_mom_6)
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
equal_returns <- returns*w
Mkt <- rowSums(equal_returns)
SMB <- rowMeans(equal_returns[1:3]) - rowMeans(equal_returns[4:6])
MOM <- rowMeans(equal_returns[c(3, 6)]) - rowMeans(equal_returns[c(1, 4)])
df <- tibble("date" = filter_data(data_matrix$subsets$data[[1]], annual)[,1], "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
calc_factors(size_mom_6)
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
equal_returns <- returns*w
Mkt <- rowSums(equal_returns)
SMB <- rowMeans(equal_returns[1:3]) - rowMeans(equal_returns[4:6])
MOM <- rowMeans(equal_returns[c(3, 6)]) - rowMeans(equal_returns[c(1, 4)])
df <- tibble("date" = filter_data(data_matrix$subsets$data[[1]], annual)[,1], "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(filter_data(data_matrix$subsets$data[[1]], annual)[,1])
}
calc_factors(size_mom_6)
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
equal_returns <- returns*w
Mkt <- rowSums(equal_returns)
SMB <- rowMeans(equal_returns[1:3]) - rowMeans(equal_returns[4:6])
MOM <- rowMeans(equal_returns[c(3, 6)]) - rowMeans(equal_returns[c(1, 4)])
df <- tibble(filter_data(data_matrix$subsets$data[[1]], annual)[,1], "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(filter_data(data_matrix$subsets$data[[1]], annual)[,1])
}
calc_factors(size_mom_6)
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
equal_returns <- returns*w
Mkt <- rowSums(equal_returns)
SMB <- rowMeans(equal_returns[1:3]) - rowMeans(equal_returns[4:6])
MOM <- rowMeans(equal_returns[c(3, 6)]) - rowMeans(equal_returns[c(1, 4)])
df <- tibble(filter_data(data_matrix$subsets$data[[1]], annual)[,1], "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
calc_factors(size_mom_6)
calc_factors(size_mom_6)
ff_3_factors$subsets$data[[1]]
calc_factors(size_mom_6)
ff_3_factors$subsets$data[[1]]
calc_factors <- function(data_matrix, annual = FALSE){
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns*w
Mkt <- rowSums(returns_w)
SMB <- rowMeans(returns_w[1:3]) - rowMeans(returns_w[4:6])
MOM <- rowMeans(returns_w[c(3, 6)]) - rowMeans(returns_w[c(1, 4)])
df <- tibble(filter_data(data_matrix$subsets$data[[1]], annual)[,1], "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
calc_factors(size_mom_6)
calc_factors <- function(data_matrix, annual = FALSE){
date_df <- filter_data(data_matrix$subsets$data[[1]], annual)[,1]
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns*w
Mkt <- rowSums(returns_w)
SMB <- rowMeans(returns_w[1:3]) - rowMeans(returns_w[4:6])
MOM <- rowMeans(returns_w[c(3, 6)]) - rowMeans(returns_w[c(1, 4)])
df <- tibble(date_df, "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
calc_factors(size_mom_6)
size_mom_6$subsets$data[[1]]
calc_factors(size_mom_6)
calc_factors(size_mom_6)
ff_3_factors$subsets$data[[1]]
calc_factors(size_mom_6)
ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409)
calc_factors <- function(data_matrix, annual = FALSE){
date_df <- filter_data(data_matrix$subsets$data[[1]], annual)[,1]
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns*w
Mkt <- rowSums(returns_w)
SMB <- rowMeans(returns[1:3]) - rowMeans(returns[4:6])
MOM <- rowMeans(returns_w[c(3, 6)]) - rowMeans(returns_w[c(1, 4)])
df <- tibble(date_df, "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
calc_factors(size_mom_6)
ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409)
calc_factors(size_mom_6) - ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409)[,c(2, 3, 4)]
calc_factors(size_mom_6) - ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409)[,c(1, 2, 3, 4)]
calc_factors(size_mom_6) - (ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))[,c(1, 2, 3, 4)]
calc_factors <- function(data_matrix, annual = FALSE){
date_df <- filter_data(data_matrix$subsets$data[[1]], annual)[,1]
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns*w
Mkt <- rowSums(returns)
SMB <- rowMeans(returns[1:3]) - rowMeans(returns[4:6])
MOM <- rowMeans(returns_w[c(3, 6)]) - rowMeans(returns_w[c(1, 4)])
df <- tibble(date_df, "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
calc_factors(size_mom_6) - (ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))[,c(1, 2, 3, 4)]
calc_factors <- function(data_matrix, annual = FALSE){
date_df <- filter_data(data_matrix$subsets$data[[1]], annual)[,1]
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns*w
Mkt <- rowSums(returns_w)
SMB <- rowMeans(returns[1:3]) - rowMeans(returns[4:6])
MOM <- rowMeans(returns_w[c(3, 6)]) - rowMeans(returns_w[c(1, 4)])
df <- tibble(date_df, "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
calc_factors(size_mom_6) - (ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))[,c(1, 2, 3, 4)]
calc_factors <- function(data_matrix, annual = FALSE){
date_df <- filter_data(data_matrix$subsets$data[[1]], annual)[,1]
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns*w
Mkt <- rowSums(returns_w)
SMB <- rowMeans(returns[1:3]) - rowMeans(returns[4:6])
MOM <- rowMeans(returns_w[c(3, 6)]) - rowMeans(returns_w[c(1, 4)])
df <- tibble(date_df, "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
calc_factors <- function(data_matrix, annual = FALSE){
date_df <- filter_data(data_matrix$subsets$data[[1]], annual)[,1]
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns/w
Mkt <- rowSums(returns_w)
SMB <- rowMeans(returns[1:3]) - rowMeans(returns[4:6])
MOM <- rowMeans(returns_w[c(3, 6)]) - rowMeans(returns_w[c(1, 4)])
df <- tibble(date_df, "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
calc_factors(size_mom_6) - (ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))[,c(1, 2, 3, 4)]
calc_factors <- function(data_matrix, annual = FALSE){
date_df <- filter_data(data_matrix$subsets$data[[1]], annual)[,1]
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns*w
Mkt <- rowSums(returns_w)
SMB <- rowMeans(returns[1:3]) - rowMeans(returns[4:6])
MOM <- rowMeans(returns_w[c(3, 6)]) - rowMeans(returns_w[c(1, 4)])
df <- tibble(date_df, "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
calc_factors(size_mom_6) - (ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))[,c(1, 2, 3, 4)]
View(data_sets)
view(data_sets)
size_BTM_6 <- download_french_data("6 Portfolios Formed on Size and Book-to-Market (2 x 3)")
size_BTM_6
size_BTM_6$subsets$name
size_BTM_6$subsets
size_BTM_6$info
size_BTM_6$subsets$data[[1]]
browse_details_page(size_BTM_6)
size_BTM_6$subsets
size_BTM_6$subsets$name
size_BTM_6$subsets$data[[2]]
size_BTM_6$subsets$data[[3]]
size_BTM_6$subsets$data[[4]]
size_BTM_6$subsets$data[[5]]
size_BTM_6$subsets$data[[4]]
size_BTM_6$subsets$data[[4]][2:nrow(size_BTM_6$subsets$data[[4]]),]
size_BTM_6$subsets$data[[4]]
size_BTM_6$subsets$data[[4]][2:nrow(size_BTM_6$subsets$data[[4]]),]
size_BTM_6$date
calc_factors <- function(data_matrix, annual = FALSE){
date_df <- filter_data(data_matrix$subsets$data[[1]], annual)[,1]
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns*w
Mkt <- rowSums(returns_w)
SMB <- rowMeans(returns[1:3]) - rowMeans(returns[4:6])
MOM <- rowMeans(returns[c(3, 6)]) - rowMeans(returns[c(1, 4)])
df <- tibble(date_df, "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
calc_factors(size_BTM_6)
calc_factors(size_mom_25)
US_factors <- calc_factors(size_mom_6)
size_mom_6$subsets$name
y.df <- size_mom_6$subsets$data[[1]] %>%
filter(date >= 200409) %>%
select(c("date","SMALL LoPRIOR"))
x.df <- ff_3_factors$subsets$data[[1]] %>%
filter(date >= 200409)
MOM.df <- size_mom_6$subsets$data[[1]] %>%
filter(date >= 200409) %>%
mutate(MOM = 1/2 * (`SMALL HiPRIOR` + `BIG HiPRIOR`) - 1/2 * (`BIG LoPRIOR` + `SMALL LoPRIOR`))
reg.df <- left_join(y.df,x.df, by = "date") %>%
mutate(excess_R = `SMALL LoPRIOR` - RF,
excess_MKT = `Mkt-RF`,
MOM = MOM.df$MOM)
reg.df
t.test(US_factors$Mkt)
t.test(US_factors$SMB)
t.test(US_factors$MOM)
t.test(US_factors$Mkt)
t.test(US_factors$MOM)
library(lmtest)
library(sandwich)
model_MOM <- lm(data = US_factors, formula = MOM~1)
coeftest(model_MOM, vcov = NeweyWest(ff_model, lag = 3))
coeftest(model_MOM, vcov = NeweyWest(model_MOM, lag = 3))
t.test(US_factors$MOM)
coeftest(model_MOM, vcov = NeweyWest(model_MOM, lag = 3))
coeftest(model_MOM, vcov = NeweyWest(model_MOM, lag = 100))
coeftest(model_MOM, vcov = NeweyWest(model_MOM, lag = 10000))
coeftest(model_MOM, vcov = NeweyWest(model_MOM, lag = 10))
coeftest(model_MOM, vcov = NeweyWest(model_MOM, lag = 3))
coeftest(model_MOM, vcov = NeweyWest(model_MOM, lag = 12))
coeftest(model_MOM, vcov = NeweyWest(model_MOM, lag = 36))
coeftest(model_MOM, vcov = NeweyWest(model_MOM, lag = 1))
US_factors
calc_factors <- function(data_matrix, annual = FALSE){
date_df <- filter_data(data_matrix$subsets$data[[1]], annual)[,1]
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns*w
Mkt <- rowSums(returns_w)
SMB <- rowMeans(returns[1:3]) - rowMeans(returns[4:6])
MOM <- rowMeans(returns[c(3, 6)]) - rowMeans(returns[c(1, 4)])
df <- tibble(date_df, "returns" = rowSums(returns_w), "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
US_factors
calc_factors <- function(data_matrix, annual = FALSE){
date_df <- filter_data(data_matrix$subsets$data[[1]], annual)[,1]
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns*w
Mkt <- rowSums(returns_w)
SMB <- rowMeans(returns[1:3]) - rowMeans(returns[4:6])
MOM <- rowMeans(returns[c(3, 6)]) - rowMeans(returns[c(1, 4)])
df <- tibble(date_df, "returns" = rowSums(returns_w), "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
US_factors <- calc_factors(size_mom_6)
US_factors
calc_factors <- function(data_matrix, annual = FALSE){
date_df <- filter_data(data_matrix$subsets$data[[1]], annual)[,1]
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns*w
Mkt <- rowSums(returns_w)
SMB <- rowMeans(returns[1:3]) - rowMeans(returns[4:6])
MOM <- rowMeans(returns[c(3, 6)]) - rowMeans(returns[c(1, 4)])
df <- tibble(date_df, "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
US_factors <- calc_factors(size_mom_6)
calc_factors <- function(data_matrix, annual = FALSE){
date_df <- filter_data(data_matrix$subsets$data[[1]], annual)[,1]
returns <- filter_data(data_matrix$subsets$data[[1]], annual)[,-1]
nfirms <- filter_data(data_matrix$subsets$data[[5]], annual)[,-1]
market_cap <- filter_data(data_matrix$subsets$data[[6]], annual)[,-1]
w <- nfirms*market_cap/(rowSums(nfirms*market_cap))
returns_w <- returns*w
Mkt <- rowSums(returns_w)
SMB <- rowMeans(returns[1:3]) - rowMeans(returns[4:6])
MOM <- rowMeans(returns[c(3, 6)]) - rowMeans(returns[c(1, 4)])
df <- tibble(date_df, "Mkt" = Mkt, "SMB" = SMB, "MOM" = MOM)
return(df)
}
US_factors <- calc_factors(size_mom_6)
US_factors
size_mom_6$subsets$data[[1]]
reg_df <- tibble(US_factors, returns = size_mom_6$subsets$data[[1]]$`SMALL LoPRIOR`)
size_mom_6$subsets$data[[1]]$`SMALL LoPRIOR`
reg_df <- tibble(US_factors, "returns" = size_mom_6$subsets$data[[1]]$`SMALL LoPRIOR`)
reg_df <- US_factors$returns = size_mom_6$subsets$data[[1]]$`SMALL LoPRIOR`
US_factors$returns = size_mom_6$subsets$data[[1]]$`SMALL LoPRIOR`
US_factors
reg_df <- US_factors
reg_df$"kage" = 2
reg_df
reg_df$"returns" = size_mom_6$subsets$data[[1]]$`SMALL LoPRIOR`
reg_df <- US_factors
reg_df$"returns" = size_mom_6$subsets$data[[1]]$`SMALL LoPRIOR`
reg_df$"returns" = size_mom_6$subsets$data[[1]]$"SMALL LoPRIOR"
size_mom_6$subsets$data[[1]]$"SMALL LoPRIOR"
reg_df$"returns" = filter_data(size_mom_6$subsets$data[[1]])$"SMALL LoPRIOR"
filter_data(size_mom_6$subsets$data[[1]])$"SMALL LoPRIOR"
reg_df
filter_data(size_mom_6$subsets$data[[1]])
filter_data(size_mom_6$subsets$data[[1]])
filter_data <- function(data, annual = FALSE){
if(annual){
data <- filter(data, date >= 2004)
} else{
data <- filter(data, date >= 200409)
}
return(data)
}
filter_data <- function(data, annual = FALSE){
if(annual){
data <- filter(data, date >= 2004)
} else{
data <- filter(data, date >= 200409)
}
return(data)
}
filter_data(size_mom_6$subsets$data[[1]])
filter_data(size_mom_6$subsets$data[[1]])
reg_df$"returns" = filter_data(size_mom_6$subsets$data[[1]])$"SMALL LoPRIOR"
reg_df <- US_factors
reg_df$"returns" = filter_data(size_mom_6$subsets$data[[1]])$"SMALL LoPRIOR"
reg_df
model_MOM <- lm(data = reg_df, formula = returns ~ Mkt + SMB + MOM)
model_US <- lm(data = reg_df, formula = returns ~ Mkt + SMB + MOM)
summary(model_US)
size_mom_6$subsets$data[[1]]
reg_df <- US_factors
reg_df$"returns" = filter_data(size_mom_6$subsets$data[[1]])$"BIG HiPRIOR"
model_US <- lm(data = reg_df, formula = returns ~ Mkt + SMB + MOM)
summary(model_US)
coeftest(model_US, vcov = NeweyWest(model_US, lag = 3))
size_mom_6$subsets$data[[1]]
size_mom_6$subsets$data[[2]]
size_mom_6$subsets$data[[3]]
w <- a*n/rowSums(a*n)
rowSums(r.e*w)
hist(round(round(rowSums(r*w), 2)-(ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))$`Mkt-RF`+(ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))$RF, 2))
n
r.e
w <- a*n/rowSums(a*n)
rowSums(r.e*w)
hist(round(round(rowSums(r*w), 2)-(ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))$`Mkt-RF`+(ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))$RF, 2))
hist(round(round(rowSums(r.e*w), 2)-(ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))$`Mkt-RF`+(ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))$RF, 2))
rowSums(r*w)
hist(round(round(rowSums(r*w), 2)-(ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))$`Mkt-RF`+(ff_3_factors$subsets$data[[1]] %>% filter(date >= 200409))$RF, 2))
