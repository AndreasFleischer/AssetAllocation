plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold")
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
scale_color_manual(values = values, labels = labels) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold")
)
cumulative_return_internal <- array(NA, c(n, n_internal))
for(i in 1:n_internal){
cumulative_return_internal[,i] <- (cumprod(1+return_internal[,i]/100)-1)*100
}
cumulative_return_df <- data.frame(
cumulative_return_min_var,
cumulative_return_internal,
cumulative_return_max_return,
cumulative_return_market
)
new_names <- c("Minimum variance", paste("point", 1:5), "Maximum return", "European Equity")
colnames(cumulative_return_df) <- new_names
values <- c(colorRampPalette(c("#D55E00", "#0072B2"))(7), "#009E73")
labels <- c("GMV", paste("Pf", 1:5, sep = " "), "Max Return", "EE")
plot_data <- cumulative_return_df %>%
mutate(Date = ym(factors_period$date)) %>%
pivot_longer(
cols = -Date,
names_to = "Portfolio",
values_to = "Cumulative_Return"
) %>%
mutate(Portfolio = factor(Portfolio, levels = new_names))
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
scale_color_manual(values = values, labels = labels) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold")
)
c(min(cumulative_return_internal[k,]), max(cumulative_return_internal[k,]))
c(min(cumulative_return_internal[k,]/n), max(cumulative_return_internal[k,]/n))
c(min(apply(return_internal, 2, sd)), max(apply(return_internal, 2, sd)))
which.max(cumulative_return_internal[k,])
which.min(sd(cumulative_return_internal[k,]))
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
scale_color_manual(values = values, labels = labels) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold")
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
scale_color_manual(values = values, labels = labels) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = c(0.02, 0.98),
legend.justification = c(0, 1),
legend.title = element_text(face = "bold"),
legend.background = element_rect(
fill = "white",
color = "grey80"
),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
scale_color_manual(values = values, labels = labels) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "bottom",
legend.title = element_text(face = "bold"),
legend.background = element_rect(
fill = "white",
color = "grey80"
),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
scale_color_manual(values = values, labels = labels) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_rect(
fill = "white",
color = "grey80"
),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
scale_color_manual(values = values, labels = labels) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
scale_color_manual(values = values, labels = labels) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.5) +
scale_color_manual(values = values, labels = labels) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.5) +
scale_color_manual(values = values, labels = labels) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.5) +
scale_color_manual(values = values, labels = labels) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.5) +
scale_color_manual(values = values, labels = labels) +
guides(color = guide_legend(override.aes = list(
shape = 15,    # 15 is the code for a solid square
size = 5,      # Adjust size as needed
linetype = 0   # This hides the line
))) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
scale_color_manual(values = values, labels = labels) +
guides(color = guide_legend(override.aes = list(
shape = 15,    # 15 is the code for a solid square
size = 5,      # Adjust size as needed
linetype = 0   # This hides the line
))) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
scale_color_manual(values = values, labels = labels) +
guides(color = guide_legend(override.aes = list(
shape = 15,    # 15 is the code for a solid square
size = 5,      # Adjust size as needed
linetype = 0   # This hides the line
))) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
guides(color = guide_legend(override.aes = list(
shape = 15,    # 15 is the code for a solid square
size = 5,      # Adjust size as needed
linetype = 0   # This hides the line
))) +
scale_color_manual(values = values, labels = labels) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
geom_point(shape = NA) +
scale_color_manual(values = values, labels = labels) +
guides(color = guide_legend(override.aes = list(
shape = 15,    # 15 is the code for a solid square
size = 5,      # Adjust size as needed
linetype = 0   # This hides the line
))) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
geom_point(shape = NA) +
scale_color_manual(values = values, labels = labels) +
guides(color = guide_legend(override.aes = list(
shape = 15,    # 15 is the code for a solid square
size = 4,      # Adjust size as needed
linetype = 0   # This hides the line
))) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
ggplot(plot_data, aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.45) +
geom_point(shape = NA) +
scale_color_manual(values = values, labels = labels) +
guides(color = guide_legend(override.aes = list(
shape = 15,    # 15 is the code for a solid square
size = 4,      # Adjust size as needed
linetype = 0   # This hides the line
))) +
labs(
title = "Cumulative Returns of Efficient Frontier Portfolios",
#subtitle = "Performance of portfolios from Minimum Variance to Maximum Return",
x = "Date",
y = "Cumulative Return",
color = "Portfolio"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
colors_pal <- colorRampPalette(c("#D55E00", "#0072B2"))(7)
k <- 1
cumulative_return_rp <- (cumprod(1+return_rp/100)-1)*100
cumulative_return_mv_chosen <- cumulative_return_internal[,k]
round(cumulative_return_rp[n], 0)-round(cumulative_return_mv_chosen[n], 0)
round(cumulative_return_rp[n]/n, 2) - round(cumulative_return_mv_chosen[n]/n, 2)
round(sd(return_rp), 2)-round(sd(return_internal[,k]), 2)
rp_df <- tibble(
Date = ym(factors_return_calc$date),
"Risk_parity" = cumulative_return_rp,
"Portfolio_1" = cumulative_return_mv_chosen,
"Current_strategy" =  cumulative_return_market
)
Breaks = c("Risk_parity", "Portfolio_1", "Current_strategy")
labels = c("RP","PF 1", "EE")
values = c("Risk_parity" = "#613F99", "Portfolio_1" = colors_pal[2], "Current_strategy" = "#009E73")
rp_df %>%
pivot_longer(cols = -Date, names_to = "Portfolio", values_to = "Cumulative_Return") %>%
ggplot(aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.7) +
scale_color_manual(
name = "Portfolio",
breaks = Breaks,
labels = labels,
values =  values
) +
labs(
title = "Cumulative Returns of Risk parity and Portfolio 1",
x = "Date",
y = "Cumulative Return"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = c(0.02, 0.98),
legend.justification = c(0, 1),
legend.title = element_text(face = "bold"),
legend.background = element_rect(
fill = "white",
color = "grey80"
),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
# df <- tibble(date = factors_return_calc$date, return = return_internal[,1])
# saveRDS(df, "returns_choice.rds")
colors_pal <- colorRampPalette(c("#D55E00", "#0072B2"))(7)
k <- 1
cumulative_return_rp <- (cumprod(1+return_rp/100)-1)*100
cumulative_return_mv_chosen <- cumulative_return_internal[,k]
round(cumulative_return_rp[n], 0)-round(cumulative_return_mv_chosen[n], 0)
round(cumulative_return_rp[n]/n, 2) - round(cumulative_return_mv_chosen[n]/n, 2)
round(sd(return_rp), 2)-round(sd(return_internal[,k]), 2)
rp_df <- tibble(
Date = ym(factors_return_calc$date),
"Risk_parity" = cumulative_return_rp,
"Portfolio_1" = cumulative_return_mv_chosen,
"Current_strategy" =  cumulative_return_market
)
Breaks = c("Risk_parity", "Portfolio_1", "Current_strategy")
labels = c("RP","PF 1", "EE")
values = c("Risk_parity" = "#613F99", "Portfolio_1" = colors_pal[2], "Current_strategy" = "#009E73")
rp_df %>%
pivot_longer(cols = -Date, names_to = "Portfolio", values_to = "Cumulative_Return") %>%
ggplot(aes(x = Date, y = Cumulative_Return, color = Portfolio)) +
geom_line(linewidth = 0.7) +
scale_color_manual(
name = "Portfolio",
breaks = Breaks,
labels = labels,
values =  values
) +
labs(
title = "Cumulative Returns of Risk parity and Portfolio 1",
x = "Date",
y = "Cumulative Return"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 13),
plot.subtitle = element_text(size = 12),
legend.position = c(0.02, 0.98),
legend.justification = c(0, 1),
legend.title = element_text(face = "bold"),
legend.background = element_rect(
fill = "white",
color = "grey80"
),
axis.title.x = element_text(face = "bold", size = 11),
axis.title.y = element_text(face = "bold", size = 11)
)
# df <- tibble(date = factors_return_calc$date, return = return_internal[,1])
# saveRDS(df, "returns_choice.rds")
